# powerquery_pyspark
Data Analysis Comparison between the functions of Power Query and PySpark
#### PySpark code for table creation
##### required libraries import
![image](https://github.com/rivthebest/powerquery_pyspark/assets/11970473/bb0deeef-7bc4-4477-a6f3-9d30e2385444)

##### PySpark session creation
![image](https://github.com/rivthebest/powerquery_pyspark/assets/11970473/094f8a6f-c775-4a1e-8ce4-45314edc6d4e)

##### dataframe generation with table column names
![image](https://github.com/rivthebest/powerquery_pyspark/assets/11970473/352a854e-2ec7-45b9-9537-38d274816b14)

##### showing the dataframe
![image](https://github.com/rivthebest/powerquery_pyspark/assets/11970473/0b874b09-c880-4abf-913c-4f979ecea47d)

#### Equivalent Power Query Code for table creation
![image](https://github.com/rivthebest/powerquery_pyspark/assets/11970473/9c5a6cb4-71e0-4640-8a6f-d8aa20ea7909)

##### table generated in Power Query 
![image](https://github.com/rivthebest/powerquery_pyspark/assets/11970473/a3e6927e-2076-49bb-9a78-f00406b7fbb0)

#### PySpark -- execution of the when() function
![image](https://github.com/rivthebest/powerquery_pyspark/assets/11970473/c2444d14-ad50-4abf-8f7d-5c751247fed3)

##### The result table after the execution of the when() function
![image](https://github.com/rivthebest/powerquery_pyspark/assets/11970473/229a82d9-aff1-4da8-b147-0813f97f3f6d)

#### Equivalent Power Query Code for fetching equivalent result as PySpark when() function
![image](https://github.com/rivthebest/powerquery_pyspark/assets/11970473/7ee03715-de13-42ee-8468-0ce93685c278)

##### And the respective table 
![image](https://github.com/rivthebest/powerquery_pyspark/assets/11970473/9b56dbbe-8958-4633-9c86-5312a8ffd91e)

#### PySpark -- executing the PySpark when() function as SQL CASE-WHEN-END syntax by wrapping withing expr() and expr() with col() functions successively
![image](https://github.com/rivthebest/powerquery_pyspark/assets/11970473/fc84c697-7e19-402f-8873-d6a3470b260f)

##### the result using expr() function
![image](https://github.com/rivthebest/powerquery_pyspark/assets/11970473/5b981452-4ace-4876-a6a6-3a24fb54cda7)

##### code execution and the result using exr() and col() function
![image](https://github.com/rivthebest/powerquery_pyspark/assets/11970473/0344919d-9f9d-4df5-926a-ed014b12ff80)

#### Equivalent Power Query function execution


#### PySpark -- execution of the split() function to make a text column as an array of Text

##### table creation in PySpark  are pasted below
![image](https://github.com/rivthebest/powerquery_pyspark/assets/11970473/04b3bf55-2e45-49d1-9331-56c2dc9436be)

![image](https://github.com/rivthebest/powerquery_pyspark/assets/11970473/ea5e361f-2f8e-4d63-816a-e0a3e5460f28)

##### data processing steps for using split() function of PySpark
![image](https://github.com/rivthebest/powerquery_pyspark/assets/11970473/e1efea8b-8001-4530-a881-4475ba69c7fa)

#### Equivalent Power Query Steps table creation
![image](https://github.com/rivthebest/powerquery_pyspark/assets/11970473/2005396b-fded-4954-8d72-f8f9966f2906)

![image](https://github.com/rivthebest/powerquery_pyspark/assets/11970473/36e33220-8a55-4e39-aa62-3fff0a0d2831)

##### Power Query steps for showing Text Field as Text Array
![image](https://github.com/rivthebest/powerquery_pyspark/assets/11970473/65c73952-cfa7-4cfe-b011-cd0efa5d841a)

![image](https://github.com/rivthebest/powerquery_pyspark/assets/11970473/50375836-8d04-490f-a2a1-bd8c5d5021c7)






